# Stage 6: Cloud Deploy

**Status**: TODO
**Prerequisites**: Database configured, secrets set (Stage 5)

---

## Overview

Deploy the application to App Platform.

---

## Pre-Deployment Checklist

- [ ] `.do/app.yaml` exists
- [ ] Database binding configured in app.yaml
- [ ] GitHub secret `DATABASE_URL` is set
- [ ] `deploy_on_push` set appropriately

---

## Deploy

### Option A: Via doctl

```bash
doctl apps create --spec .do/app.yaml
```

### Option B: Via GitHub Actions

```bash
git push origin main
```

- [ ] Deployment started
- [ ] Capture app ID: `APP_ID=`

---

## Monitor Deployment

```bash
APP_ID=$(doctl apps list --format ID,Spec.Name --no-header | grep {{APP_NAME}} | awk '{print $1}')

# Watch build
doctl apps logs $APP_ID --type build --follow

# Watch deploy
doctl apps logs $APP_ID --type deploy --follow

# Check status
doctl apps get $APP_ID --format DefaultIngress,ActiveDeployment.Phase
```

---

## Health Check

| Service | Endpoint | Expected | Status |
|---------|----------|----------|--------|
| API | /healthz | 200 OK | [ ] |
| Frontend | / | 200 OK | [ ] |

```bash
APP_URL=$(doctl apps get $APP_ID --format DefaultIngress --no-header)
curl -s $APP_URL/healthz
curl -s $APP_URL/
```

---

## Deployment Result

- [ ] App URL: `https://{{APP_NAME}}-_____.ondigitalocean.app`
- [ ] All services healthy

---

## Troubleshooting

| Issue | Solution |
|-------|----------|
| Database connection refused | Check DATABASE_URL secret |
| Build failed | Check build logs |
| Health check timeout | Check runtime logs |

---

## Next Steps

Proceed to Stage 7: Cloud Validate
